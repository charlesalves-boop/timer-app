/*
  # Create timer table

  1. New Tables
    - `timer`
      - `id` (integer, primary key, always 1)
      - `elapsed_seconds` (integer, default 0)
      - `is_running` (boolean, default false)
      - `updated_at` (timestamp)
  
  2. Security
    - Enable RLS on `timer` table
    - Add policy for public read access
    - Add policy for public write access
*/

CREATE TABLE IF NOT EXISTS timer (
  id integer PRIMARY KEY DEFAULT 1,
  elapsed_seconds integer DEFAULT 0,
  is_running boolean DEFAULT false,
  updated_at timestamptz DEFAULT now(),
  CONSTRAINT single_row CHECK (id = 1)
);

ALTER TABLE timer ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can read timer"
  ON timer FOR SELECT
  TO anon
  USING (true);

CREATE POLICY "Anyone can update timer"
  ON timer FOR UPDATE
  TO anon
  USING (id = 1)
  WITH CHECK (id = 1);

INSERT INTO timer (id, elapsed_seconds, is_running) VALUES (1, 0, false)
ON CONFLICT (id) DO NOTHING;
